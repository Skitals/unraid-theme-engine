Menu="UserPreferences"
Title="Theme Engine"
Icon="file"
---
<?php
extract(parse_plugin_cfg('theme.engine',true));
?>

<form markdown="1" name="display_settings" method="POST" action="/update.php" target="progressFrame" onsubmit="saveFontSize();upload();">
<input type="hidden" name="#file" value="dynamix/dynamix.cfg">
<input type="hidden" name="#section" value="display">
Base Theme:
: <select name="theme" size="1" id="BaseTheme">
  <?foreach (glob("$docroot/webGui/styles/dynamix-*.css") as $themes):?>
  <?$theme = substr(basename($themes,'.css'),8);?>
  <?=mk_option($display['theme'], $theme, ucfirst($theme))?>
  <?endforeach;?>
  </select>

<input type="submit" name="#default" value="Default" onclick="filename='reset'">
: <input type="submit" name="#apply" value="Apply" disabled>
</form>


<form markdown="1" name="display_settings" method="POST" action="/update.php" target="progressFrame" onsubmit="saveFontSize();upload();">
<input type="hidden" name="#file" value="theme.engine/theme.engine.cfg">
<input type="hidden" name="#section" value="ThemeEngine">
Enable Theme Engine:
: <select name="enabled" size="1">
  <?=mk_option($ThemeEngine['enabled'], "0", "No")?>
  <?=mk_option($ThemeEngine['enabled'], "1", "Yes")?>
  </select>

Text color:
: <input type="color" class="narrow" name="text" value="<?php echo $ThemeEngine['text']; ?>">


Link color:
: <input type="color" class="narrow" name="link" value="<?php echo $ThemeEngine['link']; ?>">

<input type="submit" name="#default" value="Default" onclick="filename='reset'">
: <input type="submit" name="#apply" value="Apply" disabled><input type="button" value="Done" onclick="done()">
</form>

<form markdown="1">
Theme Name:
: <input type="text" class="narrow" name="text" id="MyTheme" value="MyTheme">

Apply settings before exporting.
: <input type="submit" value="Export" onclick="ExportTheme();">
</form>


<form markdown="1">
Theme Name:
: <select name="theme" size="1" id="SelectedTheme">
  <?foreach (glob("/boot/config/plugins/theme.engine/themes/*.cfg") as $themes):?>
  <?$theme = basename($themes,'.cfg');?>
  <?=mk_option($display['theme'], $theme, ucfirst($theme))?>
  <?endforeach;?>
  </select>

Current settings will be overwriten.
: <input type="submit" value="Import" onclick="ImportTheme();"><input type="submit" value="Delete" onclick="DeleteTheme();">
</form>


<script>
$(function() {
	if ( typeof caPluginUpdateCheck === "function" ) {
		caPluginUpdateCheck("theme.engine.plg",{name:"Theme Engine"});
	}
});

function ExportTheme() {
var themename = document.getElementById("MyTheme");
var basetheme = document.getElementById("BaseTheme"); 
$.get( "/plugins/theme.engine/scripts/export.php", { name: themename.value, base: basetheme.value } )
  .done(function( data ) {
    alert( "Data Loaded: " + data );
  });
}

function ImportTheme() {
var themename = document.getElementById("SelectedTheme");
var basename = themename.value.split('-')[1]
            $.ajax({
                type: "POST",
                url: "/update.php" ,
                data: { "#file":"/boot/config/plugins/dynamix/dynamix.cfg","#section":"display","theme":basename,"#apply":"Enable Dark" },
                success : function() {
                }
            });
$.get( "/plugins/theme.engine/scripts/import.php", { name: themename.value } )
  .done(function( data ) {
    alert( "Theme Imported: " + data );
  });
}

function DeleteTheme() {
var themename = document.getElementById("SelectedTheme");
$.get( "/plugins/theme.engine/scripts/delete.php", { name: themename.value } )
  .done(function( data ) {
    alert( "Theme Deleted: " + data );
  });
}

</script>
